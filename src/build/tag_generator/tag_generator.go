package main

import (
	"fmt"
	"os"
	"unicode"
)

var availableTags = []string{
	"editor", "debug", "shipping",
}

const tagSetFmt = `// Code generated by src/build/tag_generator; DO NOT EDIT.

//go:build %s

package build

const %s = true
`

const tagNotFmt = `// Code generated by src/build/tag_generator; DO NOT EDIT.

//go:build !%s

package build

const %s = false
`

func main() { createTagFiles() }

func setFile(name string) string { return fmt.Sprintf("../z%s.go", name) }
func notFile(name string) string { return fmt.Sprintf("../z%s_not.go", name) }

func createTagFiles() {
	for i := range availableTags {
		set, err := os.Create(setFile(availableTags[i]))
		if err != nil {
			panic(err)
		}
		defer set.Close()
		not, err := os.Create(notFile(availableTags[i]))
		if err != nil {
			panic(err)
		}
		defer not.Close()
		title := []rune(availableTags[i])
		title[0] = unicode.ToUpper(title[0])
		set.WriteString(fmt.Sprintf(tagSetFmt, availableTags[i], string(title)))
		not.WriteString(fmt.Sprintf(tagNotFmt, availableTags[i], string(title)))
	}
}
